!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).calculatejs={})}(this,(function(e){"use strict";var r,n=function(){return n=Object.assign||function(e){for(var r,n=1,t=arguments.length;t>n;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e},n.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError,function(e){e.NUMBER="number",e.STRING="string",e.BOOLEAN="boolean",e.OBJECT="object",e.UNDEFINED="undefined",e.NULL="null",e.SYMBOL="symbol",e.ARRAY="array",e.DATE="date",e.FUNCTION="function"}(r||(r={}));var t=Math.pow,i=Math.abs,a=function(e,r){return+e.toFixed(r)};function o(e){return e>0?"+":0>e?"-":""}var u=4,c={isEnd:!0,decimal:u};function f(e){e=n(n({},c),e);for(var r=e.n,i=e.pmt,a=e.isEnd,o=e.decimal,u=1+e.rate/100,f=-e.pv*t(u,r),p=1;r>=p;)f-=i*t(u,a?r-p:r-p+1),p++;return+f.toFixed(o)}function p(e){e=n(n({},c),e);for(var r=e.n,i=e.pv,a=e.fv,o=e.isEnd,u=e.decimal,f=1+e.rate/100,p=0,s=1;r>=s;)p+=t(f,o?r-s:r-s+1),s++;return-((i*t(f,r)+a)/p).toFixed(u)}function s(e){e=n({decimal:u},e);var r=e.rate,i=e.decimal,o=e.initCf;return e.cfList.forEach((function(e,n){o+=e*t(1+r/100,-(n+1))})),a(o,i)}var d={isEqualPayment:!0,periodPerYear:1},l=4;function v(e){var r=(e=n(n({},d),e)).periodPerYear;if(e.isEqualPayment){var t=p({n:e.years*r,fv:0,pv:e.principal,rate:e.rate/r});return i(t)}return console.log(m(e),"-getInterestPerPeriod-"),console.log(P(e),"-getPrincipalPerPeriod-"),a(m(e)+P(e),l)}function P(e){var r=(e=n(n({},d),e)).years*e.periodPerYear;return a(e.isEqualPayment?v(e)-m(e):e.principal/r,l)}function m(e){e=n(n({},d),e);var r=e.periodPerYear,i=e.current,o=e.rate/r/100;if(e.isEqualPayment){var u=t(1+o,e.years*r);return a(e.principal*o*(u-t(1+o,i-1))/(u-1),l)}return a((e.principal-(i-1)*P(e))*o,l)}e.getFVInDFC=f,e.getIRR=function(e){var r=(e=n({decimal:u},e)).cfList,c=e.decimal,f=o(e.initCf);if(r.every((function(e){return o(e)===f})))return[];for(var p=a(t(10,-c),c),d=0,l=[];100>=d;){var v=s(n(n({},e),{rate:d}));i(v)>p||(console.log({_npv:v}),l.push(d)),d=a(d+p,c)}return l},e.getInterestPerPeriod=m,e.getNPV=s,e.getPMTInDFC=p,e.getPVInDFC=function(e){for(var r=(e=n(n({},c),e)).n,i=e.pmt,a=e.isEnd,o=e.decimal,u=1+e.rate/100,f=-e.fv*t(u,-r),p=1;r>=p;)f-=i*t(u,a?-p:1-p),p++;return+f.toFixed(o)},e.getPaymentPerPeriod=v,e.getPrincipalPerPeriod=P,e.getRateInDFC=function(e){for(var r=(e=n(n({},c),e)).n,a=e.pmt,o=e.fv,u=e.pv,p=e.isEnd,s=e.decimal,d=0,l=100,v=t(10,1-s),P=+((d+l)/2).toFixed(s);l>=P&&P>=d;){var m=f({n:r,pv:u,rate:P,pmt:a,isEnd:p,decimal:s});if(i(m-o)<=v)break;i(m)>i(o)?l=P:d=P,P=+((d+l)/2).toFixed(s)}return P},e.paymentListInLoan=function(e){for(var r=(e=n(n({},d),e)).years*e.periodPerYear,t=[],i=1;r>=i;i++){var o=n(n({},e),{current:i}),u=P(o),c=m(o),f=a(u+c,l);t.push({current:i,principal:u,interest:c,payment:f})}return t},e.totalInterestInLoan=function(e){var r=(e=n(n({},d),e)).principal,t=e.rate,i=e.periodPerYear,o=e.years*i;return a(e.isEqualPayment?o*v(e)-r:(o+1)*r*(t/i/100)/2,l)}}));
